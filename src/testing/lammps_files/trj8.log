units micro
atom_style hybrid ellipsoid paramagnet bond
boundary p p p
dimension 2
neighbor 1.0 nsq
neigh_modify every 1 delay 1 check yes
pair_style hybrid lj/cut/dipole/cut 0 200
bond_style biharmonic

### ---Create Particles and Region--- ###
read_data ././lammps_files/trj8.lmpdata
  orthogonal box = (0 0 -15) to (300 300 15)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  400 atoms
  scanning bonds ...
  1 = max bonds/atom
  200 ellipsoids
  reading bonds ...
  200 bonds
  1 = max # of 1-2 neighbors
  0 = max # of 1-3 neighbors
  0 = max # of 1-4 neighbors
  1 = max # of special neighbors
  special bonds CPU = 3.19481e-05 secs
  read_data CPU = 0.00054884 secs
group Atoms type 1
200 atoms in group Atoms
group Traps type 2
200 atoms in group Traps
mass * 1
group Atoms_1 type 1
200 atoms in group Atoms_1

### ---Variables--- ###

## magnetic field
variable Bmag atom 1.863017728500447e-05
variable freq atom 0.0
variable theta atom 0.0
variable phi atom 0.0

variable fieldx atom v_Bmag*sin(PI/2/60e6*(time-60e6))*(time>60e6)*(time<=120e6)+v_Bmag*cos(-PI/2/60e6*(time-120e6))*(time>120e6)*(time<=180e6)
variable fieldy atom 0
variable fieldz atom v_Bmag/60e6*time*(time<=60e6)+v_Bmag*cos(PI/2/60e6*(time-60e6))*(time>60e6)*(time<=120e6)+v_Bmag*-1*sin(-PI/2/60e6*(time-120e6))*(time>120e6)*(time<=180e6)

### ---Fixes--- ###

fix 	1 Atoms setdipole v_fieldx v_fieldy v_fieldz 0
fix 	2 Atoms bd 300 0.001 687560

fix 	3 Atoms addforce 0 0 -0.0

fix 	5 all enforce2d_bd

###Â ---Run Commands--- ###
timestep 	10000.0
dump 	3 all custom 5 ././lammps_files/trj8.lammpstrj id type x	 y	 z	 mux	 muy	 muz
thermo_style 	custom step atoms
thermo 	100
run 	18000
Neighbor list info ...
  update every 1 steps, delay 1 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 201
  ghost atom cutoff = 201
  3 neighbor lists, perpetual/occasional/extra = 3 0 0
  (1) pair lj/cut/dipole/cut, perpetual, skip from (3)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
  (2) fix setdipole, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (3) neighbor class addition, perpetual, half/full from (2)
      attributes: half, newton on
      pair build: halffull/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 8.733 | 8.733 | 8.733 Mbytes
Step Atoms 
       0      400 
     100      400 
     200      400 
     300      400 
     400      400 
     500      400 
     600      400 
     700      400 
     800      400 
     900      400 
    1000      400 
    1100      400 
    1200      400 
    1300      400 
    1400      400 
    1500      400 
    1600      400 
    1700      400 
    1800      400 
    1900      400 
    2000      400 
    2100      400 
    2200      400 
    2300      400 
    2400      400 
    2500      400 
    2600      400 
    2700      400 
    2800      400 
    2900      400 
    3000      400 
    3100      400 
    3200      400 
    3300      400 
    3400      400 
    3500      400 
    3600      400 
    3700      400 
    3800      400 
    3900      400 
    4000      400 
    4100      400 
    4200      400 
    4300      400 
    4400      400 
    4500      400 
    4600      400 
    4700      400 
    4800      400 
    4900      400 
    5000      400 
    5100      400 
    5200      400 
    5300      400 
    5400      400 
    5500      400 
    5600      400 
    5700      400 
    5800      400 
    5900      400 
    6000      400 
    6100      400 
    6200      400 
    6300      400 
    6400      400 
    6500      400 
    6600      400 
    6700      400 
    6800      400 
    6900      400 
    7000      400 
    7100      400 
    7200      400 
    7300      400 
    7400      400 
    7500      400 
    7600      400 
    7700      400 
    7800      400 
    7900      400 
    8000      400 
    8100      400 
    8200      400 
    8300      400 
    8400      400 
    8500      400 
    8600      400 
    8700      400 
    8800      400 
    8900      400 
    9000      400 
    9100      400 
    9200      400 
    9300      400 
    9400      400 
    9500      400 
    9600      400 
    9700      400 
    9800      400 
    9900      400 
   10000      400 
   10100      400 
   10200      400 
   10300      400 
   10400      400 
   10500      400 
   10600      400 
   10700      400 
   10800      400 
   10900      400 
   11000      400 
   11100      400 
   11200      400 
   11300      400 
   11400      400 
   11500      400 
   11600      400 
   11700      400 
   11800      400 
   11900      400 
   12000      400 
   12100      400 
   12200      400 
   12300      400 
   12400      400 
   12500      400 
   12600      400 
   12700      400 
   12800      400 
   12900      400 
   13000      400 
   13100      400 
   13200      400 
   13300      400 
   13400      400 
   13500      400 
   13600      400 
   13700      400 
   13800      400 
   13900      400 
   14000      400 
   14100      400 
   14200      400 
   14300      400 
   14400      400 
   14500      400 
   14600      400 
   14700      400 
   14800      400 
   14900      400 
   15000      400 
   15100      400 
   15200      400 
   15300      400 
   15400      400 
   15500      400 
   15600      400 
   15700      400 
   15800      400 
   15900      400 
   16000      400 
   16100      400 
   16200      400 
   16300      400 
   16400      400 
   16500      400 
   16600      400 
   16700      400 
   16800      400 
   16900      400 
   17000      400 
   17100      400 
   17200      400 
   17300      400 
   17400      400 
   17500      400 
   17600      400 
   17700      400 
   17800      400 
   17900      400 
   18000      400 
Loop time of 15.4628 on 1 procs for 18000 steps with 400 atoms

Performance: 1005766805423199.875 ns/day, 0.000 hours/ns, 1164.082 timesteps/s
99.5% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 11.069     | 11.069     | 11.069     |   0.0 | 71.59
Bond    | 0.075913   | 0.075913   | 0.075913   |   0.0 |  0.49
Neigh   | 2.4599     | 2.4599     | 2.4599     |   0.0 | 15.91
Comm    | 0.32631    | 0.32631    | 0.32631    |   0.0 |  2.11
Output  | 0.86533    | 0.86533    | 0.86533    |   0.0 |  5.60
Modify  | 0.63755    | 0.63755    | 0.63755    |   0.0 |  4.12
Other   |            | 0.02864    |            |       |  0.19

Nlocal:    400 ave 400 max 400 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    1808 ave 1808 max 1808 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    28420 ave 28420 max 28420 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  56840 ave 56840 max 56840 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 56840
Ave neighs/atom = 142.1
Ave special neighs/atom = 1
Neighbor list builds = 1559
Dangerous builds = 0
Total wall time: 0:00:15
